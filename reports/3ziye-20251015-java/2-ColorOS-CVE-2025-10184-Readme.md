> [信息来源](https://www.rapid7.com/blog/post/cve-2025-10184-oneplus-oxygenos-telephony-provider-permission-bypass-not-fixed/)  
> [漏洞原理及解决方案技术原理](https://yuuou.vercel.app/%E9%80%86%E5%90%91/%E7%9F%AD%E4%BF%A1%E6%BC%8F%E6%B4%9E%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90/)

### 漏洞说明

- 类型：数据库注入攻击`1=1 AND`
- 效果：任意APP读取短信数据。*无需权限、无需用户交互、无感知读取*
- 影响：本机的所有短信信息、短信验证码泄露
- 涉及范围：**OPPO 及其子品牌(一加、realme)**
- 影响范围：根据[maoyixuan](https://github.com/yuuouu/ColorOS-CVE-2025-10184/issues/1#issuecomment-3367827779)提交的机型显示，***17年发布的ColorOS 6.0.1存在漏洞，此漏洞可能伴随了OPPO的OEM生涯***
- 修复情况：10月4日开始对ColorOS 15推送系统文件更新：`15.0.0.860Patch01|1.9MB`，10月9日对ColorOS 12-14推送
- 测试漏洞：[国内下载 yuu_v3.6.apk](https://yuuou.lanzout.com/iiQE337s6dha)，出现短信内容代表存在漏洞。测试app不存在联网功能，[OPPO列为风险应用是通过包名匹配](https://github.com/yuuouu/ColorOS-CVE-2025-10184/issues/23)，断网安装即可，如有疑惑可查阅源码，测试完及时卸载
- 普通用户防护策略：
  1. 在厂商未修补漏洞前，请将sim卡放到使用其它品牌手机上使用
  2. 设备上的短信尽快删除，彻底删除。避免短信被用作用户画像
  3. 使用Android虚拟机或云手机安装应用
  4. 在使用短信验证时尽量保证无后台应用运行
- 自救方案：无root自救方案和root稳定拦截方案

### 修复情况更新(10月4日)
> @C和其他热心网友，[更新前确保关闭 Cross Profile Test App](https://github.com/yuuouu/ColorOS-CVE-2025-10184/issues/24)，不然会导致安装卡在0.0%

已确认开始推送修复，10月4日上午开始推送  
- 系统版本：ColorOS 15.0.0、15.0.1、15.0.2
- 实际内容：com.android.providers.telephony 15.40.10 (35)  
- 更新路径：设置 → 系统与更新 → 软件更新 → 自动更新设置 → 系统文件更新  
- 系统文件：`15.0.0.860Patch01|1.9MB`，不同机型文件不一样，以实际推送为准  
- 修复效果：  
<img src="http://upforme.ru/uploads/001c/43/d3/2/43385.jpg" width="200">  

#### 强制更新
> ~~`15.0.0.860Patch01|1.9MB 推送包的 电话_短信存储_15.40.10.apk`仅支持ColorOS 15.0.0、15.0.1、15.0.2版本，[推送包详细内容](https://github.com/yuuouu/ColorOS-CVE-2025-10184/blob/master/opex_15.0.0.860Patch01.cfg)~~
> 信息来源 电报@SnowWolf725 

[下载 电话_短信存储.apk](https://yuuou.lanzout.com/s/yuuou)，注意：要跟系统版本匹配  
使用adb命令：`adb install -t D:\xxx.apk`  
安装成功后重启手机生效，出错了卸载安装版本即可

### 漏洞效果

<img src="http://upforme.ru/uploads/001c/43/d3/2/700625.png" width="240">

[可将隐私数据打码后上传到 Issues](https://github.com/yuuouu/ColorOS-CVE-2025-10184/issues/1)

### 普通用户自救方案

#### 方案一：使用短信骚扰拦截(通用方法)
> 来自[v2ex@CoolMarket](https://www.v2ex.com/t/1162349?p=1#r_16821039)  
> 打开短信骚扰拦截，拦截所有号码，这样短信就会被收进骚扰拦截里，用软件测试发现读取不到短信

路径：短信 → 骚扰拦截 → 拦截规则 → 信息拦截 → 自定义拦截关键词 → 右上角➕号 → 按行复制输入以下内容 

```log
0,1,2,3,4,5,6,7,8,9
#,*,+,@,.,【,(,（,，
-,/,!,码,中,余,元,退,
a,b,c,d,e,f,g,h,i,j,
k,l,m,n,o,p,q,r,s,t,
u,v,w,x,y,z,A,B,C,D,
E,F,G,H,I,J,K,L,M,N,
O,P,Q,R,S,T,U,V,W,X,
Y,Z,零,一,二,三,四,五,六,
七,八,九,十,百,千,万
```
<img src="http://upforme.ru/uploads/001c/43/d3/2/346162.jpg" width="200"><img src="http://upforme.ru/uploads/001c/43/d3/2/683671.jpg" width="200"><img src="http://upforme.ru/uploads/001c/43/d3/2/136629.jpg" width="200"><img src="http://upforme.ru/uploads/001c/43/d3/2/791452.jpg" width="200"><img src="http://upforme.ru/uploads/001c/43/d3/2/348877.jpg" width="200"><img src="http://upforme.ru/uploads/001c/43/d3/2/849694.jpg" width="200">    
验证：接收一条新的短信(给10086发信息)，收到短信后在骚扰拦截那里会出现一条拦截信息，然后打开测试工具查看该信息是否出现，没有该信息的话说明此方法有效   

**此方案最简单，建议旧机型优先使用此方案**

#### 方案二：使用Shizuku修改
> 基于[v2ex@Dawnnnnnn](https://www.v2ex.com/t/1162349#r_16804643)提出的方法改进。⚠️修改系统内容有风险！非全部机型可用

1. 下载[Shizuku](https://shizuku.rikka.app/download/)和[Blocker](https://github.com/lihenggui/blocker/releases)。(提示无法安装时断开网络后安装)
2. 根据[教程选择无线调试启动Shizuku](https://shizuku.rikka.app/zh-hans/guide/setup/#%E5%90%AF%E7%94%A8%E6%97%A0%E7%BA%BF%E8%B0%83%E8%AF%95)
3. `Blocker`设置中更改`控制器种类`为`Shizuku/Sui`，`Shizuku`授权给`Blocker`
4. `Blocker`设置中打开 `显示系统应用` 
5. `Blocker`搜索`telephony`，进入`电话/短信存储`应用
6. 选择`内容提供者`，找到其中的`PushMessageProvider`、`PushShopProvider`、`ServiceNumberProvider`三个选项关闭
7. ⚠️注意：到此完成设置，效果保持到下次重启前。重启手机后将无法收到短信(能发送)，必须重新开启上一步的三个选项，再重启一次才能正常收到短信。确认能收发短信之后关闭三个选项，既有拦截效果，又能正常收发信息，将保持到下次重启
   
<img src="http://upforme.ru/uploads/001c/43/d3/2/575277.jpg" width="240"><img src="http://upforme.ru/uploads/001c/43/d3/2/719926.jpg" width="240">

##### 无法生效说明

当`com.android.providers.telephony`里`AndroidManifest.xml`存在`android:testOnly="true"`属性时才能修改生效，[具体原因可见]([https://github.com/lihenggui/blocker/issues/27](https://yuuou.vercel.app/%E9%80%86%E5%90%91/%E7%9F%AD%E4%BF%A1%E6%BC%8F%E6%B4%9E%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90/#shizuku-test-only-and-quot-true-and-quot))

### root 拦截方案

无root情况下，试了系统分身、多用户、Shelter工作账号都无法拦截此漏洞  
如何root请参考 [ColorOS刷机路径](https://yuuou.vercel.app/%E9%80%86%E5%90%91/ColorOS%20%E5%88%B7%E6%9C%BA%E8%B7%AF%E5%BE%84/)

#### 方案一：使用xposed模块

测试包包含模块内容，将捕获调用此漏洞的应用，拦截结果并弹窗提示和记录，仅需勾选"电话/短信存储"应用，保存日志路径`/storage/emulated/0/Android/data/com.android.providers.telephony/files/yuu.log`  
如有发现，请提 Issues 或通过[电报反馈](https://t.me/+Z8f7P5MMkZ0yNzE1)  

<img src="https://github.com/user-attachments/assets/baf1e6cc-bf55-44f6-834b-d2c115de2c52" width="260">

#### 方案二：禁用 Provider

> 来自[v2ex@Dawnnnnnn](https://www.v2ex.com/t/1162349#r_16804643)

1. 下载安装 [Blocker](https://github.com/lihenggui/blocker/releases) 
2. 在设置中打开 `显示系统应用`
3. 搜索 `telephony`，进入 `电话/短信存储` 
4. 选择 `内容提供者` ，找到其中的 `PushMessageProvider`、`PushShopProvider`、`ServiceNumberProvider` 三个选项关闭
5. 注意⚠️：重启手机后将导致无法收到短信(能发送)，必须重新开启上一步的三个选项，再重启一次才能正常收到短信。确认能收发短信之后再关闭三个选项，既有拦截效果，又能正常收发信息，将保持到下次重启   

<img
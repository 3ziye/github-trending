> [信息来源](https://www.rapid7.com/blog/post/cve-2025-10184-oneplus-oxygenos-telephony-provider-permission-bypass-not-fixed/)

### 漏洞说明

- 类型：数据库注入攻击`1=1 AND`
- 效果：任意APP读取短信数据。*无需权限、无需用户交互、无感知读取*
- 影响：本机的所有短信信息、短信验证码泄露
- 涉及范围：**OPPO 及其子品牌(一加、realme)**
- 影响范围：根据[maoyixuan](https://github.com/yuuouu/ColorOS-CVE-2025-10184/issues/1#issuecomment-3367827779)提交的机型显示，***17年发布的ColorOS 6.0.1存在漏洞，此漏洞可能伴随了OPPO的OEM生涯***
- 修复情况：10月4日开始推送系统文件更新：`15.0.0.860Patch01|1.9MB`，可手动更新
- 测试漏洞：[国内下载 yuu_v3.6.apk](https://yuuou.lanzout.com/iiQE337s6dha)，出现短信内容代表存在漏洞
- 普通用户防护策略：
  1. 在厂商未修补漏洞前，请将sim卡放到使用其它品牌手机上使用
  2. 设备上的短信尽快删除，彻底删除。避免短信被用作用户画像
  3. 使用Android虚拟机或云手机安装应用
  4. 在使用短信验证时尽量保证无后台应用运行
- 自救方案：有无root自救方案和root稳定拦截方案

### 修复情况更新(10月4日)
> @C和其他热心网友

已确认开始推送修复，10月4日上午开始推送  
机型：一加12、13T、ACE3、ACE3 Pro;OPPO Find x8 Pro等  
实际内容：com.android.providers.telephony 15.40.10 (35)  
更新路径：设置 → 系统与更新 → 软件更新 → 自动更新设置 → 系统文件更新  
系统文件：`15.0.0.860Patch01|1.9MB`  
效果：  
<img src="http://upforme.ru/uploads/001c/43/d3/2/43385.jpg" width="260">  

#### 强制更新
> 电报@Alearer在ColorOS 14机型上测试会报错 

`15.0.0.860Patch01|1.9MB`仅支持ColorOS 15.0.0、15.0.1、15.0.2版本，[推送包详细内容](https://github.com/yuuouu/ColorOS-CVE-2025-10184/blob/master/opex_15.0.0.860Patch01.cfg)  
[下载 电话_短信存储_15.40.10.apk](https://yuuou.lanzout.com/iTuJ937md58j)，使用adb命令：`adb install -t D:\电话_短信存储_15.40.10.apk`  
安装成功后重启手机生效，出错了卸载安装版本即可

个人想法：感谢工程师在国庆期间加班加点修补漏洞，希望大家不要把压力给到**OPPO开发工程师**。首先外部反馈漏洞到工程师真正修补漏洞之间存在很多环节，并不是工程师不想快点修补漏洞发布。另外，此漏洞可能在OPPO的初始OEM阶段就已存在，涉及的代码调用链比较底层，除了第一个写的程序员，后续接手的工程师在没有bug反馈的情况下，是比较难发现此漏洞的。希望OPPO技术开发团队能借助此次漏洞风波完善自身SRC漏洞反馈通道，更重要的是**将此次更新范围扩大，为全部受影响机型推送修补方案，而不是放弃老机型**。

### 漏洞效果

<img src="http://upforme.ru/uploads/001c/43/d3/2/700625.png" width="240">

[可将隐私数据打码后上传到 Issues](https://github.com/yuuouu/ColorOS-CVE-2025-10184/issues/1)

### 普通用户自救方案

#### 方案一：使用短信骚扰拦截
> 来自[v2ex@CoolMarket](https://www.v2ex.com/t/1162349?p=1#r_16821039)  
> 打开短信骚扰拦截，拦截所有号码，这样短信就会被收进骚扰拦截里，用软件测试发现读取不到短信

路径：短信 → 骚扰拦截 → 拦截规则设置 → 黑名单 → 右上角加号 → 开头号码匹配 → 输入`1`  
<img src="http://upforme.ru/uploads/001c/43/d3/2/346162.jpg" width="200"><img src="http://upforme.ru/uploads/001c/43/d3/2/683671.jpg" width="200"><img src="http://upforme.ru/uploads/001c/43/d3/2/230878.jpg" width="200"><img src="http://upforme.ru/uploads/001c/43/d3/2/767761.jpg" width="200"><img src="http://upforme.ru/uploads/001c/43/d3/2/559293.jpg" width="200">  
验证：接收一条新的短信(给10086发信息)，收到短信后在骚扰拦截那里会出现一条[黑名单拦截]信息，然后打开测试工具查看该信息是否出现，没有该信息的话说明此方法有效（Realme X、一加13、OPPO K3实测有效）  
后续：然后继续在`开头号码匹配`中逐个添加`0-9`，拦截全部号码。在`拦截规则设置`中设置`拦截时提醒`，会导致无法接到电话！

**此方案最简单，但是会导致无法接到电话😞**

#### 方案二：使用Shizuku修改
> 基于[v2ex@Dawnnnnnn](https://www.v2ex.com/t/1162349#r_16804643)提出的方法改进。⚠️修改系统内容有风险！非全部机型可用

1. 下载[Shizuku](https://shizuku.rikka.app/download/)和[Blocker](https://github.com/lihenggui/blocker/releases)。(提示无法安装时断开网络后安装)
2. 根据[教程选择无线调试启动Shizuku](https://shizuku.rikka.app/zh-hans/guide/setup/#%E5%90%AF%E7%94%A8%E6%97%A0%E7%BA%BF%E8%B0%83%E8%AF%95)
3. `Blocker`设置中更改`控制器种类`为`Shizuku/Sui`，`Shizuku`授权给`Blocker`
4. `Blocker`设置中打开 `显示系统应用` 
5. `Blocker`搜索`telephony`，进入`电话/短信存储`应用
6. 选择`内容提供者`，找到其中的`PushMessageProvider`、`PushShopProvider`、`ServiceNumberProvider`三个选项关闭
7. ⚠️注意：到此完成设置，效果保持到下次重启前。重启手机后将无法收到短信(能发送)，必须重新开启上一步的三个选项，再重启一次才能正常收到短信。确认能收发短信之后关闭三个选项，既有拦截效果，又能正常收发信息，将保持到下次重启
   
<img src="http://upforme.ru/uploads/001c/43/d3/2/575277.jpg" width="240"><img src="http://upforme.ru/uploads/001c/43/d3/2/719926.jpg" width="240">

##### 无法生效说明

当`com.android.providers.telephony`里`AndroidManifest.xml`存在`android:testOnly="true"`属性时才能修改生效，[具体可见](https://github.com/lihenggui/blocker/issues/27)

### root 拦截方案

无root情况下，试了系统分身、多用户、Shelter工作账号都无法拦截此漏洞  
如何root请参考 [ColorOS刷机路径](https://yuuou.vercel.app/%E9%80%86%E5%90%91/ColorOS%20%E5%88%B7%E6%9C%BA%E8%B7%AF%E5%BE%84/)

#### 方案一：使用xposed模块

测试包包含模块内容，将捕获调用此漏洞的应用，拦截结果并弹窗提示和记录，仅需勾选"电话/短信存储"应用，保存日志路径`/storage/emulated/0/Android/data/com.android.providers.telephony/files/yuu.log`  
如有发现，请提 Issues 或通过[电报反馈](https://t.me/+Z8f7P5MMkZ0yNzE1)  

<img src="https://github.com/user-attachments/assets/baf1e6cc-bf55-44f6-834b-d2c115de2c52" width="260">

#### 方案二：禁用 Provider

> 来自[v2ex@Dawnnnnnn](https://www.v2ex.com/t/1162349#r_16804643)

1. 下载安装 [Blocker](https://github.com/lihenggui/blocker/releases) 
2. 在设置中打开 `显示系统应用`
3. 搜索 `telephony`，进入 `电话/短信存储` 
4. 选择 `内容提供者` ，找到其中的 `PushMessageProvider`、`PushShopProvider`、`ServiceNumberProvider` 三个选项关闭
5. 注意⚠️：重启手机后将导致无法收到短信(能发送)，必须重新开启上一步的三个选项，再重启一次才能正常收到短信。确认能收发短信之后再关闭三个选项，既有拦截效果，又能正常收发信息，将保持到下次重启   

<img src="http://upforme.ru/uploads/001c/43/d3/2/719926.jpg" width="260">

#### 方案三：限制读取数据库文件

> 来自酷安@kkkkkcc

1. 打开 `MT管理器`，进入目录 `/data/data/com.android.providers.telephony/databases/` 
2. 禁用读取权限：长按 `mmssms.db` - `属性` - `权限 更改` - `去除读权限，包括所有者和用户组`
3. 将无法发送短信，需自测

<img src="http://upforme.ru/uploads/001c/43/d3/2/244342.jpg" width="260">

### 披露时间线

```
2025年5月1日：Rapid7通过电子邮件联系一加安全响应中心（OneSRC），请求就漏洞披露进行沟通。未收到回复。
2025年5月6日：Rapid7再次通过电子邮件联系OneSRC。未收到回复。
2025年7月2日：Rapid7同时通过电子邮件联系一加客服支持团队和OneSRC。
2025年7月3日：一加客服回复称将向内部相关团队
> [信息来源](https://www.rapid7.com/blog/post/cve-2025-10184-oneplus-oxygenos-telephony-provider-permission-bypass-not-fixed/)

### 漏洞说明

- 类型：数据库注入攻击`1=1 AND`
- 效果：任意APP读取短信数据。*无需权限、无需用户交互、无感知读取*
- 影响：本机的所有短信信息、短信验证码泄露
- 涉及范围：**OPPO 及其子品牌(一加、realme)**
- ***影响范围更新：19年发布的ColorOS 7.1存在此漏洞，合理推测此漏洞至少存在了六年***
- 修复情况：厂商已在9月24日回应**rapid7**（漏洞发现者）正在调查该问题
- 测试漏洞：安装 [`yuu_v3.1.apk`](https://yuuou.lanzout.com/iUGNs37c5g6f)，执行一分钟即可看到数据，执行完成没有数据说明你的手机没有被此漏洞影响
- 普通用户防护策略：
  1. 在厂商未修补漏洞前，请将sim卡放到使用其它品牌手机上使用
  2. 设备上的短信尽快删除，彻底删除。避免短信被用作用户画像
  3. 使用Android虚拟机或云手机安装应用
  4. 在使用短信验证时尽量保证无后台应用运行
- ***自救方案：需要root！选择下方的自救方案。如何root请参考 [ColorOS刷机路径](https://yuuou.vercel.app/%E9%80%86%E5%90%91/ColorOS%20%E5%88%B7%E6%9C%BA%E8%B7%AF%E5%BE%84/)***

### 无root用户临时自救方案
> 基于[v2ex@Dawnnnnnn](https://www.v2ex.com/t/1162349#r_16804643)提出的方法改进。⚠️修改系统内容有风险！

1. 下载[Shizuku](https://shizuku.rikka.app/download/)和[Blocker](https://github.com/lihenggui/blocker/releases)。(提示无法安装时断开网络后安装)
2. 根据[教程选择无线调试启动Shizuku](https://shizuku.rikka.app/zh-hans/guide/setup/#%E5%90%AF%E7%94%A8%E6%97%A0%E7%BA%BF%E8%B0%83%E8%AF%95)
3. `Blocker`设置中更改`控制器种类`为`Shizuku/Sui`，`Shizuku`授权给`Blocker`
4. `Blocker`设置中打开 `显示系统应用` 
5. `Blocker`搜索`telephony`，进入`电话/短信存储`应用
6. 选择`内容提供者`，找到其中的`PushMessageProvider`、`PushShopProvider`、`ServiceNumberProvider`三个选项关闭
7. 注意⚠️：重启手机后将导致无法收到短信(能发送)，必须重新开启上一步的三个选项，再重启一次才能正常收到短信。确认能收发短信之后关闭三个选项，既有拦截效果，又能正常收发信息，将保持到下次重启
   
<img src="http://upforme.ru/uploads/001c/43/d3/2/575277.jpg" width="240"><img src="http://upforme.ru/uploads/001c/43/d3/2/719926.jpg" width="240">

### 漏洞效果

<img src="http://upforme.ru/uploads/001c/43/d3/2/700625.png" width="240">

[可将隐私数据打码后上传到 Issues](https://github.com/yuuouu/ColorOS-CVE-2025-10184/issues/1)

### 自救方案 (需要 root)

无root情况下，试了系统分身、多用户、Shelter工作账号都无法拦截此漏洞

#### 方案一：使用xposed模块

`yuu_v3.1.apk`包含模块内容，将捕获调用此漏洞的应用，拦截结果并弹窗提示和记录，需要手动勾选应用。  
如有发现，请提 Issues 或通过[电报反馈](https://t.me/+Z8f7P5MMkZ0yNzE1)  
<img src="https://github.com/user-attachments/assets/d3ee17bf-9847-4d1d-bbe7-ef9039d9bb4f" width="260">

#### 方案二：禁用 Provider

> 来自[v2ex@Dawnnnnnn](https://www.v2ex.com/t/1162349#r_16804643)

1. 下载安装 [Blocker](https://github.com/lihenggui/blocker/releases) 
2. 在设置中打开 `显示系统应用`
3. 搜索 `telephony`，进入 `电话/短信存储` 
4. 选择 `内容提供者` ，找到其中的 `PushMessageProvider`、`PushShopProvider`、`ServiceNumberProvider` 三个选项关闭
5. 注意⚠️：重启手机后将导致无法收到短信(能发送)，必须重新开启上一步的三个选项，再重启一次才能正常收到短信。确认能收发短信之后再关闭三个选项，既有拦截效果，又能正常收发信息，将保持到下次重启   

<img src="http://upforme.ru/uploads/001c/43/d3/2/719926.jpg" width="260">

#### 方案三：限制读取数据库文件

> 来自酷安@kkkkkcc

1. 打开 `MT管理器`，进入目录 `/data/data/com.android.providers.telephony/databases/` 
2. 禁用读取权限：长按 `mmssms.db` - `属性` - `权限 更改` - `去除读权限，包括所有者和用户组`
3. 可能在特定机型上会出现无法收到短信，需自测

<img src="http://upforme.ru/uploads/001c/43/d3/2/244342.jpg" width="260">

### 披露时间线

```
2025年5月1日：Rapid7通过电子邮件联系一加安全响应中心（OneSRC），请求就漏洞披露进行沟通。未收到回复。
2025年5月6日：Rapid7再次通过电子邮件联系OneSRC。未收到回复。
2025年7月2日：Rapid7同时通过电子邮件联系一加客服支持团队和OneSRC。
2025年7月3日：一加客服回复称将向内部相关团队转达Rapid7请求，随后联系获取更多信息。此后再未收到后续回复。
2025年7月10日：Rapid7联系一加客服要求跟进。未收到回复。
2025年7月22日：Rapid7向OneSRC的X平台账号发送消息，请求漏洞披露沟通渠道。未获回应。
2025年8月16日：Rapid7联系与OnePlus存在业务往来的 OPPO CNA 代表，请求引荐 OneSRC 团队。未获回应。
2025年9月23日：Rapid7认定OnePlus为未响应供应商，通过本披露博文公开发布CVE-2025-10184漏洞。
2025年9月24日：研究发布后，OnePlus回复Rapid7确认收到披露信息，并表示正在调查该问题。
```

### 漏洞调用字段含义

`SELECT address FROM sms ORDER BY rowid DESC LIMIT 3`
- LIMIT 3：最近的 3 个
- body：短信正文内容。可修改为下面的任意字段

| 字段名                            | 含义说明                       |
| ------------------------------ | -------------------------- |
| _id                            | 主键，自增 ID                   |
| thread_id                      | 会话 ID，归属到哪个对话线程            |
| address                        | 短信发送方或接收方号码                |
| person                         | 联系人 ID（可能对应 Contacts 表）    |
| date                           | 收到/发送时间（毫秒时间戳）             |
| date_sent                      | 实际发送时间（对发出短信有效）            |
| protocol                       | 协议：0=SMS, 1=MMS            |
| read                           | 是否已读（0=未读, 1=已读）           |
| status                         | 发送状态（-1=接收, 0=成功, 64=待发送等） |
| type                           | 短信类型（1=收件箱, 2=已发件, 3=草稿等）  |
| reply_path_present             | 是否设置了回复路径                  |
| subject                        | 短信主题（MMS 可能有）              |
| body                           | 短信正文内容                     |
| service_center                 | 服务中心号码 (SMSC)              |
| locked                         | 是否锁定（防止被系统清理）              |
| sub_id                         | 使用的 SIM 卡 ID               |
| phone_id                       | 手机卡槽 ID                    |
| error_code                     | 发送错误码                      |
| creator                        | 创建该短信的应用包名                 |
| seen                           | 是否已在界面展示（0/1）              |
| priority                       | 短信优先级（厂商/IMS扩展）            |
| m_size                         | 消息大小（多见于 MMS）              |
| oplus_drafts                   | Oplus 定制：草稿标记              |
| oplus_mass          
# ECH Workers å®¢æˆ·ç«¯

[![GitHub release](https://img.shields.io/github/release/byJoey/ech-wk.svg)](https://github.com/byJoey/ech-wk/releases)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

è·¨å¹³å°çš„ ECH Workers ä»£ç†å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Windowsã€macOS å’Œ Linuxï¼ˆARM/x86ï¼‰ï¼Œæä¾›å›¾å½¢ç•Œé¢å’Œå‘½ä»¤è¡Œä¸¤ç§ä½¿ç”¨æ–¹å¼ã€‚

## ðŸ“‹ ç›®å½•

- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [ç‰ˆæœ¬æ›´æ–°](#ç‰ˆæœ¬æ›´æ–°)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [å‘½ä»¤è¡Œä½¿ç”¨](#å‘½ä»¤è¡Œä½¿ç”¨)
- [å›¾å½¢ç•Œé¢ä½¿ç”¨](#å›¾å½¢ç•Œé¢ä½¿ç”¨)
- [è½¯è·¯ç”±éƒ¨ç½²](#è½¯è·¯ç”±éƒ¨ç½²)
- [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
- [æ•…éšœæŽ’é™¤](#æ•…éšœæŽ’é™¤)
- [æŠ€æœ¯æ–‡æ¡£](#æŠ€æœ¯æ–‡æ¡£)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **ECH åŠ å¯†** - åŸºäºŽ TLS 1.3 ECH (Encrypted Client Hello) æŠ€æœ¯ï¼ŒåŠ å¯† SNI ä¿¡æ¯
- âœ… **å¤šåè®®æ”¯æŒ** - åŒæ—¶æ”¯æŒ SOCKS5 å’Œ HTTP CONNECT ä»£ç†åè®®
- âœ… **æ™ºèƒ½åˆ†æµ** - ä¸‰ç§åˆ†æµæ¨¡å¼ï¼šå…¨å±€ä»£ç†ã€è·³è¿‡ä¸­å›½å¤§é™†ã€ç›´è¿žæ¨¡å¼
- âœ… **IPv4/IPv6 åŒæ ˆ** - å®Œæ•´æ”¯æŒ IPv4 å’Œ IPv6 åœ°å€çš„åˆ†æµåˆ¤æ–­

### å›¾å½¢ç•Œé¢åŠŸèƒ½
- âœ… **å¤šæœåŠ¡å™¨ç®¡ç†** - æ”¯æŒå¤šä¸ªæœåŠ¡å™¨é…ç½®ï¼Œå¿«é€Ÿåˆ‡æ¢
- âœ… **ä¸€é”®ç³»ç»Ÿä»£ç†** - è‡ªåŠ¨è®¾ç½®ç³»ç»Ÿä»£ç†ï¼Œæ”¯æŒåˆ†æµæ¨¡å¼
- âœ… **ç³»ç»Ÿæ‰˜ç›˜** - æœ€å°åŒ–åˆ°ç³»ç»Ÿæ‰˜ç›˜ï¼Œä¸å ç”¨ä»»åŠ¡æ 
- âœ… **å¼€æœºè‡ªå¯** - æ”¯æŒ Windows å’Œ macOS å¼€æœºè‡ªåŠ¨å¯åŠ¨
- âœ… **é«˜ DPI æ”¯æŒ** - å®Œç¾Žæ”¯æŒé«˜åˆ†è¾¨çŽ‡æ˜¾ç¤ºå™¨
- âœ… **å®žæ—¶æ—¥å¿—** - æŸ¥çœ‹ä»£ç†è¿è¡ŒçŠ¶æ€å’Œæ—¥å¿—
- âœ… **é…ç½®æŒä¹…åŒ–** - è‡ªåŠ¨ä¿å­˜é…ç½®ï¼Œä¸‹æ¬¡å¯åŠ¨è‡ªåŠ¨åŠ è½½

### é«˜çº§åŠŸèƒ½
- âœ… **è‡ªåŠ¨ IP åˆ—è¡¨æ›´æ–°** - è‡ªåŠ¨ä¸‹è½½å¹¶åº”ç”¨å®Œæ•´çš„ä¸­å›½ IP åˆ—è¡¨ï¼ˆIPv4/IPv6ï¼‰
- âœ… **DNS ä¼˜é€‰** - æ”¯æŒè‡ªå®šä¹‰ DoH æœåŠ¡å™¨è¿›è¡Œ ECH æŸ¥è¯¢
- âœ… **IP ç›´è¿ž** - æ”¯æŒæŒ‡å®šæœåŠ¡ç«¯ IPï¼Œç»•è¿‡ DNS è§£æž
- âœ… **è·¨å¹³å°æ”¯æŒ** - Windowsã€macOSã€Linuxï¼ˆx86_64/ARM64ï¼‰

## ðŸ†• ç‰ˆæœ¬æ›´æ–°

### v1.3 æœ€æ–°ä¼˜åŒ–

#### æ ¸å¿ƒåŠŸèƒ½å¢žå¼º
- **IPv6 å®Œæ•´æ”¯æŒ**
  - æ–°å¢ž IPv6 åœ°å€åˆ†æµåˆ¤æ–­åŠŸèƒ½
  - è‡ªåŠ¨ä¸‹è½½å¹¶åŠ è½½ä¸­å›½ IPv6 IP åˆ—è¡¨ï¼ˆ`chn_ip_v6.txt`ï¼‰
  - æ”¯æŒ IPv4/IPv6 åŒæ ˆçŽ¯å¢ƒä¸‹çš„æ™ºèƒ½åˆ†æµ

- **æ™ºèƒ½ IP åˆ—è¡¨ç®¡ç†**
  - è‡ªåŠ¨æ£€æµ‹ IP åˆ—è¡¨æ–‡ä»¶æ˜¯å¦å­˜åœ¨æˆ–ä¸ºç©º
  - æ–‡ä»¶ç¼ºå¤±æ—¶è‡ªåŠ¨ä»Ž GitHub ä¸‹è½½æœ€æ–°åˆ—è¡¨
  - æ”¯æŒ IPv4 å’Œ IPv6 åˆ—è¡¨çš„ç‹¬ç«‹ç®¡ç†
  - åˆ—è¡¨æ¥æºï¼š[mayaxcn/china-ip-list](https://github.com/mayaxcn/china-ip-list)

- **åˆ†æµé€»è¾‘ä¼˜åŒ–**
  - åˆ†æµåˆ¤æ–­é€»è¾‘ç§»è‡³ Go æ ¸å¿ƒç¨‹åºï¼Œæ€§èƒ½æ›´ä¼˜
  - æ”¯æŒåŸŸåè§£æžåŽçš„å¤š IP åœ°å€åˆ¤æ–­
  - æ”¹è¿›çš„äºŒåˆ†æŸ¥æ‰¾ç®—æ³•ï¼Œæå‡æŸ¥è¯¢æ•ˆçŽ‡

#### å‘½ä»¤è¡Œä½“éªŒæ”¹è¿›
- **é»˜è®¤è¡Œä¸ºä¼˜åŒ–**
  - å‘½ä»¤è¡Œæ¨¡å¼ä¸‹ï¼Œ`-routing` å‚æ•°é»˜è®¤å€¼æ”¹ä¸º `global`ï¼ˆå…¨å±€ä»£ç†ï¼‰
  - æ›´ç¬¦åˆå‘½ä»¤è¡Œç”¨æˆ·çš„ä½¿ç”¨ä¹ æƒ¯
  - GUI æ¨¡å¼ä¸å—å½±å“ï¼Œä»ä½¿ç”¨é…ç½®çš„é»˜è®¤å€¼

- **å‚æ•°è¯´æ˜Žå®Œå–„**
  - æ›´æ–°å¸®åŠ©ä¿¡æ¯ï¼Œæ˜Žç¡®å„å‚æ•°çš„ä½œç”¨å’Œé»˜è®¤å€¼
  - æ·»åŠ åˆ†æµæ¨¡å¼çš„è¯¦ç»†è¯´æ˜Ž

#### å…¼å®¹æ€§æå‡
- **å‘åŽå…¼å®¹**
  - ä¿æŒä¸Žæ—§ç‰ˆæœ¬é…ç½®æ–‡ä»¶çš„å…¼å®¹æ€§
  - è‡ªåŠ¨è¿ç§»å’Œå‡çº§é…ç½®æ ¼å¼
  - å¹³æ»‘å‡çº§ä½“éªŒ

### åŽ†å²ç‰ˆæœ¬

#### v1.0
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- åŸºç¡€ä»£ç†åŠŸèƒ½
- å›¾å½¢ç•Œé¢æ”¯æŒ
- ç³»ç»Ÿä»£ç†è®¾ç½®

## ðŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³• 1: ä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼ˆæŽ¨èï¼‰

ä»Ž [GitHub Releases](https://github.com/byJoey/ech-wk/releases) ä¸‹è½½å¯¹åº”å¹³å°çš„åŽ‹ç¼©åŒ…ï¼š

#### æ¡Œé¢ç‰ˆæœ¬ï¼ˆåŒ…å« GUIï¼‰
- **Windows x64**: `ECHWorkers-windows-amd64.zip`
- **macOS Intel**: `ECHWorkers-darwin-amd64.zip`
- **macOS Apple Silicon**: `ECHWorkers-darwin-arm64.zip`
- **Linux x86_64**: `ECHWorkers-linux-amd64.tar.gz`
- **Linux ARM64**: `ECHWorkers-linux-arm64.tar.gz`

#### è½¯è·¯ç”±ç‰ˆæœ¬ï¼ˆä»…å‘½ä»¤è¡Œï¼‰
- **Linux x86_64**: `ECHWorkers-linux-amd64-softrouter.tar.gz`
- **Linux ARM64**: `ECHWorkers-linux-arm64-softrouter.tar.gz`
#### Dockerç‰ˆæœ¬ï¼ˆä»…æµ‹è¯•x86ï¼‰
- **DockerHubä»“åº“**ï¼šhttps://hub.docker.com/r/cirnosalt/ech-workers-docker
#### å®‰è£…æ­¥éª¤

1. **è§£åŽ‹æ–‡ä»¶**
   ```bash
   # Windows: è§£åŽ‹åˆ°ä»»æ„ç›®å½•
   # macOS/Linux: è§£åŽ‹åˆ° /usr/local/bin æˆ–è‡ªå®šä¹‰ç›®å½•
   tar -xzf ECHWorkers-linux-amd64.tar.gz
   ```

2. **è®¾ç½®æ‰§è¡Œæƒé™**ï¼ˆLinux/macOSï¼‰
   ```bash
   chmod +x ech-workers
   chmod +x ECHWorkersGUI  # å¦‚æžœä½¿ç”¨ GUI
   ```

3. **è¿è¡Œç¨‹åº**
   - **Windows**: åŒå‡» `ECHWorkersGUI.exe` å¯åŠ¨ GUIï¼Œæˆ–è¿è¡Œ `ech-workers.exe` ä½¿ç”¨å‘½ä»¤è¡Œ
   - **macOS/Linux**: è¿è¡Œ `./ECHWorkersGUI` å¯åŠ¨ GUIï¼Œæˆ–è¿è¡Œ `./ech-workers` ä½¿ç”¨å‘½ä»¤è¡Œ

> **æ³¨æ„**: é¢„ç¼–è¯‘ç‰ˆæœ¬å·²åŒ…å«æ‰€æœ‰ä¾èµ–ï¼Œæ— éœ€å®‰è£… Python æˆ–ä»»ä½•å…¶ä»–è½¯ä»¶ã€‚  
> é¦–æ¬¡è¿è¡Œ"è·³è¿‡ä¸­å›½å¤§é™†"æ¨¡å¼æ—¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨ä¸‹è½½ IP åˆ—è¡¨æ–‡ä»¶ã€‚

## ðŸ’» å‘½ä»¤è¡Œä½¿ç”¨

`ech-workers` æ”¯æŒçº¯å‘½ä»¤è¡Œè¿è¡Œï¼Œé€‚åˆæœåŠ¡å™¨çŽ¯å¢ƒã€è½¯è·¯ç”±æˆ–æ— å›¾å½¢ç•Œé¢åœºæ™¯ã€‚

### å‘½ä»¤è¯­æ³•

```bash
ech-workers [é€‰é¡¹]
```

### å‚æ•°è¯´æ˜Ž

#### å¿…éœ€å‚æ•°

| å‚æ•° | è¯´æ˜Ž | ç¤ºä¾‹ |
|------|------|------|
| `-f` | æœåŠ¡ç«¯åœ°å€ï¼ˆå¿…éœ€ï¼‰ | `-f your-worker.workers.dev:443` |

#### å¯é€‰å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜Ž | ç¤ºä¾‹ |
|------|--------|------|------|
| `-l` | `127.0.0.1:30000` | æœ¬åœ°ç›‘å¬åœ°å€ | `-l 0.0.0.0:30001` |
| `-token` | ç©º | èº«ä»½éªŒè¯ä»¤ç‰Œ | `-token your-token-here` |
| `-ip` | ç©º | æŒ‡å®šæœåŠ¡ç«¯ IPï¼ˆç»•è¿‡ DNSï¼‰ | `-ip 1.2.3.4` |
| `-dns` | `dns.alidns.com/dns-query` | ECH æŸ¥è¯¢ DoH æœåŠ¡å™¨ | `-dns dns.alidns.com/dns-query` |
| `-ech` | `cloudflare-ech.com` | ECH æŸ¥è¯¢åŸŸå | `-ech cloudflare-ech.com` |
| `-routing` | `global` | åˆ†æµæ¨¡å¼ | `-routing bypass_cn` |

#### åˆ†æµæ¨¡å¼è¯´æ˜Ž

| æ¨¡å¼ | å€¼ | è¯´æ˜Ž |
|------|-----|------|
| **å…¨å±€ä»£ç†** | `global` | æ‰€æœ‰æµé‡éƒ½èµ°ä»£ç†ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰ |
| **è·³è¿‡ä¸­å›½å¤§é™†** | `bypass_cn` | ä¸­å›½ IP ç›´è¿žï¼Œå…¶ä»–èµ°ä»£ç† |
| **ç›´è¿žæ¨¡å¼** | `none` | æ‰€æœ‰æµé‡ç›´è¿žï¼Œä¸è®¾ç½®ä»£ç† |

> **æ³¨æ„**: 
> - ä½¿ç”¨ `bypass_cn` æ¨¡å¼æ—¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨ä¸‹è½½ä¸­å›½ IP åˆ—è¡¨ï¼ˆIPv4/IPv6ï¼‰
> - å¦‚æžœ IP åˆ—è¡¨æ–‡ä»¶ä¸å­˜åœ¨æˆ–ä¸ºç©ºï¼Œç¨‹åºä¼šè‡ªåŠ¨ä»Ž GitHub ä¸‹è½½
> - IP åˆ—è¡¨æ–‡ä»¶ä¿å­˜åœ¨ç¨‹åºç›®å½•ï¼š`chn_ip.txt`ï¼ˆIPv4ï¼‰å’Œ `chn_ip_v6.txt`ï¼ˆIPv6ï¼‰

### ä½¿ç”¨ç¤ºä¾‹

#### åŸºæœ¬ç”¨æ³•

```bash
# Windows
ech-workers.exe -f your-worker.workers.dev:443

# macOS / Linux
./ech-workers -f your-worker.workers.dev:443
```

#### æŒ‡å®šç›‘å¬åœ°å€

```bash
# ç›‘å¬æ‰€æœ‰ç½‘ç»œæŽ¥å£ï¼ˆé€‚åˆè½¯è·¯ç”±ï¼‰
./ech-workers -f your-worker.workers.dev:443 -l 0.0.0.0:30001

# ä»…ç›‘å¬æœ¬åœ°ï¼ˆé»˜è®¤ï¼‰
./ech-workers -f your-worker.workers.dev:443 -l 127.0.0.1:30001
```

#### ä½¿ç”¨åˆ†æµæ¨¡å¼

```bash
# å…¨å±€ä»£ç†æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
./ech-workers -f your-worker.workers.dev:443 -routing global

# è·³è¿‡ä¸­å›½å¤§é™†æ¨¡å¼ï¼ˆè‡ªåŠ¨ä¸‹è½½ IP åˆ—è¡¨ï¼‰
./ech-workers -f your-worker.workers.dev:443 -routing bypass_cn

# ç›´è¿žæ¨¡å¼
./ech-workers -f your-worker.workers.dev:443 -routing none
```

#### å®Œæ•´å‚æ•°ç¤ºä¾‹

```bash
./ech-workers \
  -f your-worker.workers.dev:443 \
  -l 0.0.0.0:30001 \
  -token your-token \
  -ip saas.sin.fan \
  -dns dns.alidns.com/dns-query \
  -ech cloudflare-ech.com \
  -routing bypass_cn
```

#### æŸ¥çœ‹å¸®åŠ©

```bash
./ech-workers -h
# æˆ–
./ech-workers --help
```

### åŽå°è¿è¡Œ

#### Linux/macOS

**ä½¿ç”¨ nohup:**
```bash
nohup ./ech-workers -f your-worker.workers.dev:443 -l 127.0.0.1:30001 > ech-workers.log 2>&1 &
```

**ä½¿ç”¨ screen:**
```bash
screen -S ech-work